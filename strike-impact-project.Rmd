---
title: "strike-impact-project"
author: "Kehan Liu"
date: "27/04/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(dplyr)
library(readr)
library(ggplot2)
library(knitr)
library(psych)

options(scipen = 999)

likert_levels <- c(
  "Strongly disagree", 
  "Disagree", 
  "Neither agree nor disagree", 
  "Agree", 
  "Strongly agree") 

d_strike_impact <- read_csv(
  '../data/Survey.csv',
  col_types = cols(
    col_character(),
    col_factor(),
    col_number(),
    col_number(),
    col_factor(ordered = TRUE, levels = likert_levels),
    col_factor(ordered = TRUE, levels = likert_levels),
    col_factor(ordered = TRUE, levels = likert_levels),
    col_factor(ordered = TRUE, levels = likert_levels),
    col_character()
  ))

d_strike_impact <- d_strike_impact %>%
  mutate(
    across(
      .cols = c(starts_with('learn'), 'forget_knowledge', 'admin_impact'),
      .fns = as.numeric,
      .names = '{.col}_coded'
    )
  )

keys_list <- list(
  strike_attitude = c(
    'learn_interest_coded',
    'learn_pressure_coded',
    'forget_knowledge_coded',
    'admin_impact_coded'
  )
)

strike_impact_scores <- scoreItems(
  keys = keys_list,
  items = d_strike_impact,
  totals = FALSE,
  missing = TRUE, 
  impute = 'none'
)

d_strike_impact <- cbind(d_strike_impact, strike_impact_scores$scores)

```




